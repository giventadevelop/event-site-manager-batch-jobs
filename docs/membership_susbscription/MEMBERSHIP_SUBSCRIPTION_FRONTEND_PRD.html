<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Membership Subscription Feature - Frontend PRD</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #2D2A26;
            background-color: #F5F1E8;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #FFFFFF;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(139, 125, 107, 0.1);
        }

        h1 {
            font-family: 'Crimson Text', serif;
            font-size: 2.5em;
            color: #8B7D6B;
            margin-bottom: 10px;
            border-bottom: 3px solid #8B7D6B;
            padding-bottom: 10px;
        }

        h2 {
            font-family: 'Crimson Text', serif;
            font-size: 2em;
            color: #6B4E3D;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #A0926B;
            padding-bottom: 8px;
        }

        h3 {
            font-family: 'Crimson Text', serif;
            font-size: 1.5em;
            color: #8B7D6B;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            font-family: 'Crimson Text', serif;
            font-size: 1.25em;
            color: #6B4E3D;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background-color: #EDE7D3;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            color: #6B4E3D;
        }

        pre {
            background-color: #2D2A26;
            color: #F5F1E8;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }

        pre code {
            background-color: transparent;
            color: #F5F1E8;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #FFFFFF;
        }

        th, td {
            border: 1px solid #A0926B;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #8B7D6B;
            color: #FFFFFF;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #F5F1E8;
        }

        .info-box {
            background-color: #EDE7D3;
            border-left: 4px solid #8B7D6B;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background-color: #FFF4E6;
            border-left: 4px solid #A67C52;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background-color: #E8F5E9;
            border-left: 4px solid #4A6741;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .toc {
            background-color: #EDE7D3;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
        }

        .toc ul {
            list-style-type: none;
            margin-left: 0;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: #6B4E3D;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-primary {
            background-color: #8B7D6B;
            color: #FFFFFF;
        }

        .footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 2px solid #A0926B;
            text-align: center;
            color: #8B7D6B;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Membership Subscription Feature - Frontend PRD <span class="badge badge-primary">v1.0</span></h1>

        <div class="info-box">
            <strong>Document Information:</strong><br>
            <strong>Version:</strong> 1.0<br>
            <strong>Date:</strong> 2025-01-27<br>
            <strong>Status:</strong> Implementation Ready<br>
            <strong>Project:</strong> Frontend (Next.js)<br>
            <strong>Location:</strong> <code>E:\project_workspace\mosc-temp</code><br>
            <strong>Backend Project:</strong> <code>E:\project_workspace\malayalees-us-site-boot</code>
        </div>

        <div class="warning-box">
            <strong>⚠️ Important Notes:</strong>
            <ul>
                <li>This project is already in active development - infrastructure, database schema, and basic tooling are complete</li>
                <li>Focus ONLY on feature implementation, NOT infrastructure setup</li>
                <li>All API calls must follow <code>.cursor/rules/nextjs_api_routes.mdc</code> patterns</li>
                <li>All UI components must follow <code>shared-cursor-rules/ui_style_guide.mdc</code> standards</li>
                <li>All DTOs must match backend schema from <code>documentation/Swagger_API_Docs/api-docs.json</code></li>
                <li>Database schema verified: <code>membership_plan</code> and <code>membership_subscription</code> tables exist in <code>code_html_template/SQLS/Latest_Schema_Post__Blob_Claude_11.sql</code></li>
            </ul>
        </div>

        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#overview">1. Overview</a></li>
                <li><a href="#requirements">2. Functional Requirements</a></li>
                <li><a href="#pages-components">3. Pages & Components</a></li>
                <li><a href="#api-integration">4. API Integration</a></li>
                <li><a href="#ui-standards">5. UI/UX Standards</a></li>
                <li><a href="#dto-types">6. DTOs & Type Definitions</a></li>
                <li><a href="#implementation">7. Implementation Tasks</a></li>
                <li><a href="#testing">8. Testing Requirements</a></li>
            </ul>
        </div>

        <h2 id="overview">1. Overview</h2>
        <p>This document specifies the <strong>frontend implementation</strong> for the Membership Subscription feature. The frontend will provide user-facing pages and components for viewing membership plans, subscribing to plans, and managing subscriptions.</p>

        <h3>Key Frontend Features</h3>
        <ul>
            <li><strong>Membership Plans Page</strong>: Display available membership plans in a responsive grid</li>
            <li><strong>Subscription Signup Page</strong>: Allow users to subscribe to a plan with payment</li>
            <li><strong>Subscription Management Page</strong>: View current subscription, upgrade/downgrade, cancel</li>
            <li><strong>Admin Membership Plan Management</strong>: CRUD operations for membership plans</li>
            <li><strong>Admin Subscription Management</strong>: View and manage all user subscriptions</li>
        </ul>

        <h3>Technical Stack</h3>
        <ul>
            <li><strong>Framework:</strong> Next.js 15+ (App Router)</li>
            <li><strong>Language:</strong> TypeScript</li>
            <li><strong>Styling:</strong> Tailwind CSS (MOSC Styling Standards)</li>
            <li><strong>Payment:</strong> Stripe (via UniversalPaymentCheckout component)</li>
            <li><strong>Authentication:</strong> Clerk</li>
            <li><strong>API Pattern:</strong> Next.js API Routes (Proxy Pattern)</li>
        </ul>

        <h2 id="requirements">2. Functional Requirements</h2>

        <h3>FR1: Membership Plans Display</h3>
        <ul>
            <li><strong>FR1.1</strong>: Display all active membership plans for the tenant</li>
            <li><strong>FR1.2</strong>: Show plan name, price, billing interval, features, trial period</li>
            <li><strong>FR1.3</strong>: Responsive grid layout (1 column mobile, 3 columns desktop)</li>
            <li><strong>FR1.4</strong>: "Subscribe" button for each plan</li>
            <li><strong>FR1.5</strong>: Highlight current user's active plan (if subscribed)</li>
        </ul>

        <h3>FR2: Subscription Signup</h3>
        <ul>
            <li><strong>FR2.1</strong>: User selects a membership plan</li>
            <li><strong>FR2.2</strong>: Redirect to subscription signup page with plan details</li>
            <li><strong>FR2.3</strong>: Display plan summary (name, price, billing interval, trial period)</li>
            <li><strong>FR2.4</strong>: Integrate UniversalPaymentCheckout component for payment</li>
            <li><strong>FR2.5</strong>: Handle Stripe Checkout Session creation</li>
            <li><strong>FR2.6</strong>: Redirect to success page after payment</li>
        </ul>

        <h3>FR3: Subscription Management</h3>
        <ul>
            <li><strong>FR3.1</strong>: Display current subscription status</li>
            <li><strong>FR3.2</strong>: Show current period dates, next billing date</li>
            <li><strong>FR3.3</strong>: Allow subscription upgrade/downgrade</li>
            <li><strong>FR3.4</strong>: Allow subscription cancellation (with end-of-period option)</li>
            <li><strong>FR3.5</strong>: Update payment method</li>
            <li><strong>FR3.6</strong>: View subscription history</li>
        </ul>

        <h3>FR4: Admin Membership Plan Management</h3>
        <ul>
            <li><strong>FR4.1</strong>: List all membership plans (admin view)</li>
            <li><strong>FR4.2</strong>: Create new membership plan</li>
            <li><strong>FR4.3</strong>: Edit existing membership plan</li>
            <li><strong>FR4.4</strong>: Delete membership plan (with validation)</li>
            <li><strong>FR4.5</strong>: Activate/deactivate plans</li>
        </ul>

        <h3>FR5: Admin Subscription Management</h3>
        <ul>
            <li><strong>FR5.1</strong>: List all user subscriptions</li>
            <li><strong>FR5.2</strong>: Filter by status, plan, tenant</li>
            <li><strong>FR5.3</strong>: View subscription details</li>
            <li><strong>FR5.4</strong>: Manually cancel subscriptions</li>
            <li><strong>FR5.5</strong>: View subscription metrics</li>
        </ul>

        <h2 id="pages-components">3. Pages & Components</h2>

        <h3>3.1 Public Pages</h3>

        <h4>Page: /membership/plans</h4>
        <p><strong>Purpose:</strong> Display available membership plans for users to browse and select</p>
        <p><strong>Components:</strong></p>
        <ul>
            <li><code>MembershipPlansPage</code> (Server Component)</li>
            <li><code>MembershipPlanCard</code> (Client Component)</li>
            <li><code>PlanFeaturesList</code> (Client Component)</li>
        </ul>
        <p><strong>Data Fetching:</strong></p>
        <ul>
            <li>Server-side: Fetch plans from <code>GET /api/proxy/membership-plans?isActive.equals=true</code></li>
            <li>Server-side: Fetch user's current subscription (if authenticated)</li>
        </ul>

        <h4>Page: /membership/subscribe/[planId]</h4>
        <p><strong>Purpose:</strong> Subscription signup page with payment form</p>
        <p><strong>Components:</strong></p>
        <ul>
            <li><code>SubscriptionSignupPage</code> (Server Component)</li>
            <li><code>PlanSummaryCard</code> (Client Component)</li>
            <li><code>UniversalPaymentCheckout</code> (Existing Component)</li>
        </ul>
        <p><strong>Data Fetching:</strong></p>
        <ul>
            <li>Server-side: Fetch plan details from <code>GET /api/proxy/membership-plans/{planId}</code></li>
            <li>Server-side: Verify user profile exists</li>
        </ul>

        <h3>3.2 Authenticated Pages</h3>

        <h4>Page: /membership/manage</h4>
        <p><strong>Purpose:</strong> User's subscription management dashboard</p>
        <p><strong>Components:</strong></p>
        <ul>
            <li><code>SubscriptionManagementPage</code> (Server Component)</li>
            <li><code>CurrentSubscriptionCard</code> (Client Component)</li>
            <li><code>SubscriptionActions</code> (Client Component)</li>
            <li><code>BillingHistory</code> (Client Component)</li>
        </ul>
        <p><strong>Data Fetching:</strong></p>
        <ul>
            <li>Server-side: Fetch user's subscription from <code>GET /api/proxy/membership-subscriptions/by-user/{userId}</code></li>
            <li>Server-side: Fetch related plan details</li>
        </ul>

        <h3>3.3 Admin Pages</h3>

        <h4>Page: /admin/membership/plans</h4>
        <p><strong>Purpose:</strong> Admin interface for managing membership plans</p>
        <p><strong>Components:</strong></p>
        <ul>
            <li><code>AdminMembershipPlansPage</code> (Server Component)</li>
            <li><code>MembershipPlanList</code> (Client Component)</li>
            <li><code>MembershipPlanForm</code> (Client Component)</li>
            <li><code>PlanFormModal</code> (Client Component)</li>
        </ul>
        <p><strong>Data Fetching:</strong></p>
        <ul>
            <li>Server-side: Fetch all plans from <code>GET /api/proxy/membership-plans</code></li>
            <li>Server-side: Verify admin access</li>
        </ul>

        <h4>Page: /admin/membership/subscriptions</h4>
        <p><strong>Purpose:</strong> Admin interface for managing user subscriptions</p>
        <p><strong>Components:</strong></p>
        <ul>
            <li><code>AdminSubscriptionsPage</code> (Server Component)</li>
            <li><code>SubscriptionsTable</code> (Client Component)</li>
            <li><code>SubscriptionFilters</code> (Client Component)</li>
            <li><code>SubscriptionDetailsModal</code> (Client Component)</li>
        </ul>
        <p><strong>Data Fetching:</strong></p>
        <ul>
            <li>Server-side: Fetch subscriptions with pagination from <code>GET /api/proxy/membership-subscriptions</code></li>
            <li>Server-side: Verify admin access</li>
        </ul>

        <h2 id="api-integration">4. API Integration</h2>

        <div class="warning-box">
            <strong>⚠️ CRITICAL: API Integration Rules</strong>
            <p>All API calls MUST follow the patterns defined in <code>.cursor/rules/nextjs_api_routes.mdc</code>:</p>
            <ul>
                <li>✅ Use proxy API routes: <code>/api/proxy/membership-plans</code>, <code>/api/proxy/membership-subscriptions</code></li>
                <li>✅ Use <code>createProxyHandler</code> from <code>src/lib/proxyHandler.ts</code> for all proxy routes</li>
                <li>✅ Use <code>fetchWithJwtRetry</code> for all server-side backend API calls</li>
                <li>✅ Never call backend APIs directly from client components</li>
                <li>✅ Use server actions (<code>ApiServerActions.ts</code>) for all mutations</li>
                <li>✅ Use <code>withTenantId</code> utility for all DTOs</li>
                <li>✅ Do NOT add <code>tenantId.equals</code> in client code (proxy handles it)</li>
                <li>✅ Use <code>buildQueryString</code> helper for query parameters</li>
                <li>✅ Handle errors gracefully with user-friendly messages</li>
            </ul>
        </div>

        <h3>4.1 Proxy API Routes to Create</h3>

        <h4>Route: /api/proxy/membership-plans</h4>
        <p><strong>File:</strong> <code>src/pages/api/proxy/membership-plans/index.ts</code></p>
        <p><strong>Methods:</strong> GET, POST</p>
        <p><strong>Backend Path:</strong> <code>/api/membership-plans</code></p>
        <pre><code>import { createProxyHandler } from '@/lib/proxyHandler';
export default createProxyHandler({ backendPath: '/api/membership-plans' });</code></pre>

        <h4>Route: /api/proxy/membership-plans/[...slug]</h4>
        <p><strong>File:</strong> <code>src/pages/api/proxy/membership-plans/[...slug].ts</code></p>
        <p><strong>Methods:</strong> GET, PUT, PATCH, DELETE</p>
        <p><strong>Backend Path:</strong> <code>/api/membership-plans</code></p>
        <pre><code>import { createProxyHandler } from '@/lib/proxyHandler';
export default createProxyHandler({ backendPath: '/api/membership-plans' });</code></pre>

        <h4>Route: /api/proxy/membership-subscriptions</h4>
        <p><strong>File:</strong> <code>src/pages/api/proxy/membership-subscriptions/index.ts</code></p>
        <p><strong>Methods:</strong> GET, POST</p>
        <p><strong>Backend Path:</strong> <code>/api/membership-subscriptions</code></p>
        <pre><code>import { createProxyHandler } from '@/lib/proxyHandler';
export default createProxyHandler({ backendPath: '/api/membership-subscriptions' });</code></pre>

        <h4>Route: /api/proxy/membership-subscriptions/[...slug]</h4>
        <p><strong>File:</strong> <code>src/pages/api/proxy/membership-subscriptions/[...slug].ts</code></p>
        <p><strong>Methods:</strong> GET, PUT, PATCH, DELETE</p>
        <p><strong>Backend Path:</strong> <code>/api/membership-subscriptions</code></p>
        <pre><code>import { createProxyHandler } from '@/lib/proxyHandler';
export default createProxyHandler({ backendPath: '/api/membership-subscriptions' });</code></pre>

        <h3>4.2 Server Actions</h3>

        <h4>File: src/app/membership/plans/ApiServerActions.ts</h4>
        <p><strong>Purpose:</strong> Server actions for membership plans page</p>
        <pre><code>import { fetchWithJwtRetry } from '@/lib/proxyHandler';
import { getAppUrl } from '@/lib/env';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;

export async function fetchMembershipPlansServer(filters?: {
  isActive?: boolean;
  sort?: string;
}) {
  const baseUrl = getAppUrl();
  const params = new URLSearchParams();
  if (filters?.isActive !== undefined) {
    params.append('isActive.equals', String(filters.isActive));
  }
  if (filters?.sort) {
    params.append('sort', filters.sort);
  }

  const url = `${baseUrl}/api/proxy/membership-plans${params.toString() ? `?${params.toString()}` : ''}`;
  const res = await fetch(url, { cache: 'no-store' });
  if (!res.ok) return [];
  return await res.json();
}</code></pre>

        <h4>File: src/app/membership/subscribe/[planId]/ApiServerActions.ts</h4>
        <p><strong>Purpose:</strong> Server actions for subscription signup</p>
        <pre><code>import { fetchWithJwtRetry } from '@/lib/proxyHandler';
import { withTenantId } from '@/lib/withTenantId';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;

export async function fetchMembershipPlanServer(planId: number) {
  const res = await fetchWithJwtRetry(
    `${API_BASE_URL}/api/membership-plans/${planId}`,
    { cache: 'no-store' }
  );
  if (!res.ok) return null;
  return await res.json();
}

export async function createSubscriptionCheckoutSessionServer(planId: number, userId: string) {
  const baseUrl = getAppUrl();
  const res = await fetch(`${baseUrl}/api/billing/manage-subscription`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(withTenantId({
      planId,
      userId,
      action: 'subscribe'
    })),
  });
  if (!res.ok) throw new Error('Failed to create checkout session');
  return await res.json();
}</code></pre>

        <h3>4.3 DTOs & Types</h3>
        <p><strong>File:</strong> <code>src/types/index.ts</code></p>
        <p><strong>Note:</strong> DTOs must match backend schema from <code>documentation/Swagger_API_Docs/api-docs.json</code></p>
        <p><strong>Required DTOs:</strong></p>
        <ul>
            <li><code>MembershipPlanDTO</code> - Already exists, verify fields match backend</li>
            <li><code>MembershipSubscriptionDTO</code> - Already exists, verify fields match backend</li>
        </ul>
        <p><strong>Update DTOs if needed:</strong></p>
        <pre><code>export interface MembershipPlanDTO {
  id?: number;
  tenantId: string;
  planName: string;
  planCode: string;
  description?: string;
  planType: 'SUBSCRIPTION' | 'ONE_TIME' | 'FREEMIUM';
  billingInterval: 'MONTHLY' | 'QUARTERLY' | 'YEARLY' | 'ONE_TIME';
  price: number;
  currency: string;
  trialDays: number;
  isActive: boolean;
  maxEventsPerMonth?: number;
  maxAttendeesPerEvent?: number;
  featuresJson?: Record&lt;string, any&gt;;
  stripePriceId?: string;
  stripeProductId?: string;
  createdAt?: string;
  updatedAt?: string;
}

export interface MembershipSubscriptionDTO {
  id?: number;
  tenantId: string;
  userProfileId: number;
  membershipPlanId: number;
  subscriptionStatus: 'ACTIVE' | 'TRIAL' | 'CANCELLED' | 'PAST_DUE' | 'EXPIRED' | 'SUSPENDED';
  currentPeriodStart: string; // date (YYYY-MM-DD)
  currentPeriodEnd: string; // date (YYYY-MM-DD)
  trialStart?: string; // date (YYYY-MM-DD)
  trialEnd?: string; // date (YYYY-MM-DD)
  cancelAtPeriodEnd: boolean;
  cancelledAt?: string; // date-time
  cancellationReason?: string;
  stripeSubscriptionId?: string;
  stripeCustomerId?: string;
  paymentProviderConfigId?: number;
  createdAt?: string; // date-time
  updatedAt?: string; // date-time
  // Relations
  membershipPlan?: MembershipPlanDTO;
  userProfile?: UserProfileDTO;
}</code></pre>

        <h2 id="ui-standards">5. UI/UX Standards</h2>

        <div class="info-box">
            <strong>✅ UI Standards Reference</strong>
            <p>All UI components MUST follow <code>shared-cursor-rules/ui_style_guide.mdc</code>:</p>
            <ul>
                <li>Page containers: <code>max-w-5xl mx-auto px-8 py-8</code></li>
                <li>Content cards: <code>bg-white rounded-lg shadow-md p-6</code></li>
                <li>Input fields: Standard Tailwind classes with focus states</li>
                <li>Buttons: Primary (blue), Secondary (teal), Destructive (red)</li>
                <li>Typography: MOSC styling standards (Crimson Text headings, Source Sans Pro body)</li>
                <li>Colors: Warm earth tones (#F5F1E8 background, #8B7D6B primary)</li>
                <li>Spacing: Sacred spacing (2rem) for vertical spacing</li>
            </ul>
        </div>

        <h3>5.1 Membership Plans Page Layout</h3>
        <p><strong>Layout:</strong></p>
        <ul>
            <li>Hero section with title and description</li>
            <li>Responsive grid: <code>grid grid-cols-1 md:grid-cols-3 gap-8</code></li>
            <li>Plan cards with hover effects</li>
            <li>Mobile-first responsive design</li>
        </ul>

        <h3>5.2 Plan Card Component</h3>
        <p><strong>Structure:</strong></p>
        <ul>
            <li>Card header with plan name</li>
            <li>Price display (large, prominent)</li>
            <li>Billing interval (e.g., "per month")</li>
            <li>Features list (bullet points)</li>
            <li>Trial period badge (if applicable)</li>
            <li>CTA button ("Subscribe" or "Current Plan")</li>
        </ul>

        <h3>5.3 Subscription Management Page Layout</h3>
        <p><strong>Structure:</strong></p>
        <ul>
            <li>Current subscription card (prominent)</li>
            <li>Subscription details (dates, status, plan)</li>
            <li>Action buttons (Upgrade, Downgrade, Cancel, Update Payment)</li>
            <li>Billing history table</li>
            <li>Upcoming plans section (for upgrades)</li>
        </ul>

        <h2 id="implementation">6. Implementation Tasks</h2>

        <h3>Phase 1: Core Pages (Week 1)</h3>
        <ol>
            <li><strong>Create Membership Plans Page</strong>
                <ul>
                    <li>Create <code>src/app/membership/plans/page.tsx</code></li>
                    <li>Create <code>src/app/membership/plans/ApiServerActions.ts</code></li>
                    <li>Create <code>src/components/membership/MembershipPlanCard.tsx</code></li>
                    <li>Create <code>src/components/membership/PlanFeaturesList.tsx</code></li>
                    <li>Test plan display and filtering</li>
                </ul>
            </li>
            <li><strong>Create Subscription Signup Page</strong>
                <ul>
                    <li>Create <code>src/app/membership/subscribe/[planId]/page.tsx</code></li>
                    <li>Create <code>src/app/membership/subscribe/[planId]/ApiServerActions.ts</code></li>
                    <li>Create <code>src/components/membership/PlanSummaryCard.tsx</code></li>
                    <li>Integrate UniversalPaymentCheckout component</li>
                    <li>Test subscription flow</li>
                </ul>
            </li>
        </ol>

        <h3>Phase 2: Subscription Management (Week 2)</h3>
        <ol>
            <li><strong>Create Subscription Management Page</strong>
                <ul>
                    <li>Create <code>src/app/membership/manage/page.tsx</code></li>
                    <li>Create <code>src/app/membership/manage/ApiServerActions.ts</code></li>
                    <li>Create <code>src/components/membership/CurrentSubscriptionCard.tsx</code></li>
                    <li>Create <code>src/components/membership/SubscriptionActions.tsx</code></li>
                    <li>Create <code>src/components/membership/BillingHistory.tsx</code></li>
                    <li>Test subscription management features</li>
                </ul>
            </li>
        </ol>

        <h3>Phase 3: Admin Interface (Week 3)</h3>
        <ol>
            <li><strong>Create Admin Membership Plans Page</strong>
                <ul>
                    <li>Create <code>src/app/admin/membership/plans/page.tsx</code></li>
                    <li>Create <code>src/app/admin/membership/plans/ApiServerActions.ts</code></li>
                    <li>Create <code>src/components/admin/membership/MembershipPlanList.tsx</code></li>
                    <li>Create <code>src/components/admin/membership/MembershipPlanForm.tsx</code></li>
                    <li>Create <code>src/components/admin/membership/PlanFormModal.tsx</code></li>
                    <li>Test CRUD operations</li>
                </ul>
            </li>
            <li><strong>Create Admin Subscriptions Page</strong>
                <ul>
                    <li>Create <code>src/app/admin/membership/subscriptions/page.tsx</code></li>
                    <li>Create <code>src/app/admin/membership/subscriptions/ApiServerActions.ts</code></li>
                    <li>Create <code>src/components/admin/membership/SubscriptionsTable.tsx</code></li>
                    <li>Create <code>src/components/admin/membership/SubscriptionFilters.tsx</code></li>
                    <li>Create <code>src/components/admin/membership/SubscriptionDetailsModal.tsx</code></li>
                    <li>Test subscription management</li>
                </ul>
            </li>
        </ol>

        <h3>Phase 4: Proxy API Routes (Week 1-2)</h3>
        <ol>
            <li><strong>Create Membership Plans Proxy Routes</strong>
                <ul>
                    <li>Create <code>src/pages/api/proxy/membership-plans/index.ts</code></li>
                    <li>Create <code>src/pages/api/proxy/membership-plans/[...slug].ts</code></li>
                    <li>Use <code>createProxyHandler</code> from <code>src/lib/proxyHandler.ts</code></li>
                    <li>Test GET, POST, PUT, PATCH, DELETE operations</li>
                </ul>
            </li>
            <li><strong>Create Membership Subscriptions Proxy Routes</strong>
                <ul>
                    <li>Create <code>src/pages/api/proxy/membership-subscriptions/index.ts</code></li>
                    <li>Create <code>src/pages/api/proxy/membership-subscriptions/[...slug].ts</code></li>
                    <li>Use <code>createProxyHandler</code> from <code>src/lib/proxyHandler.ts</code></li>
                    <li>Test GET, POST, PUT, PATCH, DELETE operations</li>
                </ul>
            </li>
        </ol>

        <h2 id="testing">7. Testing Requirements</h2>

        <h3>7.1 Unit Testing</h3>
        <ul>
            <li>Test component rendering</li>
            <li>Test form validation</li>
            <li>Test API action functions</li>
        </ul>

        <h3>7.2 Integration Testing</h3>
        <ul>
            <li>Test API proxy routes</li>
            <li>Test server actions</li>
            <li>Test payment flow integration</li>
        </ul>

        <h3>7.3 E2E Testing</h3>
        <ul>
            <li>Test complete subscription signup flow</li>
            <li>Test subscription management</li>
            <li>Test admin CRUD operations</li>
            <li>Test mobile responsiveness</li>
        </ul>

        <h2 id="references">8. Key References</h2>

        <div class="success-box">
            <h3>Documentation References</h3>
            <ul>
                <li><strong>API Routes Rules:</strong> <code>.cursor/rules/nextjs_api_routes.mdc</code></li>
                <li><strong>UI Style Guide:</strong> <code>shared-cursor-rules/ui_style_guide.mdc</code></li>
                <li><strong>API Schema:</strong> <code>documentation/Swagger_API_Docs/api-docs.json</code></li>
                <li><strong>Database Schema:</strong> <code>code_html_template/SQLS/Latest_Schema_Post__Blob_Claude_11.sql</code></li>
                <li><strong>MOSC Styling Standards:</strong> <code>.cursor/rules/mosc_styling_standards.mdc</code></li>
            </ul>

            <h3>Existing Components to Reuse</h3>
            <ul>
                <li><code>UniversalPaymentCheckout</code> - Payment component</li>
                <li><code>ErrorDialog</code> - Error handling</li>
                <li><code>Button</code> - Standard button component</li>
                <li><code>Input</code> - Standard input component</li>
            </ul>

            <h3>Backend Project</h3>
            <ul>
                <li><strong>Location:</strong> <code>E:\project_workspace\malayalees-us-site-boot</code></li>
                <li><strong>API Base URL:</strong> <code>process.env.NEXT_PUBLIC_API_BASE_URL</code></li>
            </ul>
        </div>

        <div class="footer">
            <p><strong>Membership Subscription Feature - Frontend PRD</strong></p>
            <p>Version 1.0 | Date: 2025-01-27</p>
            <p>Frontend Project: <code>E:\project_workspace\mosc-temp</code></p>
        </div>
    </div>
</body>
</html>



